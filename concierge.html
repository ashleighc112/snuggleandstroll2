<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Pet Care Concierge | Snuggle & Stroll</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 2rem;
      background: #fafafa;
    }
    h1, h2, h3 {
      color: #333;
    }
    form label {
      display: block;
      margin: 0.5rem 0;
    }
    input, select, textarea {
      width: 100%;
      padding: 0.5rem;
      margin-top: 0.25rem;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    button {
      margin-top: 1rem;
      padding: 0.75rem 1.5rem;
      background: #ff7f50;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1rem;
    }
    button:hover {
      background: #ff5722;
    }
    #results {
      background: white;
      padding: 1.5rem;
      margin-top: 2rem;
      border-radius: 6px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .sitter-card {
      background: #f0f8ff;
      padding: 1rem;
      margin: 1rem 0;
      border-radius: 6px;
    }
  </style>
</head>

<body>

<h1>Pet Care Concierge</h1>
<p>Answer a few questions and we’ll build a personalized daily plan and match you with the right sitter.</p>

<form id="pet-form">

  <h2>Pet Basics</h2>
  <label>Pet name:
    <input type="text" name="name" required>
  </label>

  <label>Species:
    <select name="species">
      <option value="dog">Dog</option>
      <option value="cat">Cat</option>
      <option value="other">Other</option>
    </select>
  </label>

  <label>Breed:
    <input type="text" name="breed" placeholder="e.g., Dachshund">
  </label>

  <label>Age (years):
    <input type="number" name="age" min="0" step="0.5">
  </label>

  <label>Weight (lbs):
    <input type="number" name="weight" min="0">
  </label>

  <h2>Temperament & Behavior</h2>
  <label>Energy level:
    <select name="energy">
      <option value="low">Low</option>
      <option value="medium">Medium</option>
      <option value="high">High</option>
    </select>
  </label>

  <label>Temperament (describe):
    <textarea name="temperament" rows="3" placeholder="Anxious, shy, friendly, reactive..."></textarea>
  </label>

  <h2>Health & Special Needs</h2>
  <label>Medical conditions:
    <textarea name="medical" rows="2"></textarea>
  </label>

  <label>Medications:
    <textarea name="medications" rows="2"></textarea>
  </label>

  <h2>Daily Routine</h2>
  <label>Number of walks per day:
    <input type="number" name="walks_per_day" min="0" max="6">
  </label>

  <label>Typical walk length:
    <select name="walk_length">
      <option>15 minutes</option>
      <option>30 minutes</option>
      <option>45 minutes</option>
      <option>60+ minutes</option>
    </select>
  </label>

  <label>Alone time tolerance:
    <select name="alone_time">
      <option>0–1 hour</option>
      <option>1–3 hours</option>
      <option>3–6 hours</option>
      <option>6+ hours</option>
    </select>
  </label>

  <h2>Home & Preferences</h2>
  <label>Home type:
    <select name="home_type">
      <option>Apartment</option>
      <option>House (no yard)</option>
      <option>House with yard</option>
    </select>
  </label>

  <label>ZIP code:
    <input type="text" name="zip">
  </label>

  <label>Service needed:
    <select name="service_type">
      <option>Walks</option>
      <option>Drop-in visits</option>
      <option>Overnights</option>
      <option>Daycare</option>
      <option>Boarding</option>
    </select>
  </label>

  <button type="submit">Generate care plan & sitter match</button>
</form>

<div id="results" style="display:none;">
  <h2>Your Personalized Care Plan</h2>
  <div id="care-plan"></div>

  <h2>Your Sitter Match</h2>
  <div id="sitter-match"></div>
</div>

<script>
  async function loadCareGuides() {
    try {
      const response = await fetch('data/care_guides.json');
      return await response.json();
    } catch (e) {
      console.error("Error loading care guides:", e);
      return [];
    }
  }

  function pickRelevantGuides(careGuides, pet) {
    const species = pet.species.toLowerCase();
    const breed = (pet.breed || "").toLowerCase();
    const temperament = (pet.temperament || "").toLowerCase();
    const energy = pet.energy.toLowerCase();

    return careGuides.filter(g => {
      if (g.species !== species) return false;
      if (g.breed && breed.includes(g.breed)) return true;
      if (energy === "high" && g.tags.includes("high_energy")) return true;
      if (temperament.includes("anxious") && g.tags.includes("anxious")) return true;
      return g.tags.includes("daily") || g.tags.includes("routine");
    });
  }

  function buildCarePlanHtml(pet, guides) {
    let html = `
      <p><strong>Overview for ${pet.name}:</strong> Based on your answers, here is a suggested daily and weekly routine.</p>
      <h3>Daily Routine</h3>
      <ul>
        <li>Feed on a consistent schedule (morning & evening).</li>
        <li>${pet.walks_per_day || 1} walk(s) per day, around ${pet.walk_length} each.</li>
        <li>At least one mental enrichment session daily (sniff walk, puzzle toy, training).</li>
      </ul>

      <h3>Weekly Focus</h3>
      <ul>
        <li>Grooming or brushing based on coat type.</li>
        <li>1–2 special enrichment activities (new walking route, scent game).</li>
      </ul>
    `;

    if (guides.length > 0) {
      html += `<h3>Special Considerations</h3>`;
      guides.forEach(g => {
        html += `<h4>${g.title}</h4><p>${g.content}</p>`;
      });
    }

    html += `<p><em>This is general care guidance, not medical advice.</em></p>`;
    return html;
  }

  function buildSitterMatchHtml(pet) {
    return `
      <div class="sitter-card">
        <h3>Example Sitter Match</h3>
        <p>For a ${pet.energy}-energy dog with temperament described as "${pet.temperament}", we recommend a sitter experienced with similar dogs.</p>
        <p>In the full pilot, this section will show real sitter profiles from your RAG database.</p>
      </div>
    `;
  }

  document.getElementById('pet-form').addEventListener('submit', async function (e) {
    e.preventDefault();

    const formData = new FormData(e.target);
    const pet = Object.fromEntries(formData.entries());

    const guides = await loadCareGuides();
    const relevant = pickRelevantGuides(guides, pet);

    document.getElementById('care-plan').innerHTML = buildCarePlanHtml(pet, relevant);
    document.getElementById('sitter-match').innerHTML = buildSitterMatchHtml(pet);
    document.getElementById('results').style.display = 'block';
  });
</script>

</body>
</html>
